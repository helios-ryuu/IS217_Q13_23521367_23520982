1. Danh sách tai nạn theo trạng thái có tín hiệu giao thông hay không.

SELECT
    {[Measures].[Total Accidents]} ON COLUMNS,
    [Environment].[Traffic Signal].[Traffic Signal].MEMBERS ON ROWS
FROM [AccidentCube];
----------------------------------------------------------------------
2. Khoảng cách trung bình của vụ tai nạn theo tiểu bang.

SELECT
    {[Measures].[Avg Distance]} ON COLUMNS,
    [Location].[State].[State].MEMBERS ON ROWS
FROM [AccidentCube];
----------------------------------------------------------------------
3. Phân tích tai nạn theo múi giờ.

SELECT
    {[Measures].[Total Accidents]} ON COLUMNS,
    [Location].[Timezone].[Timezone].MEMBERS ON ROWS
FROM [AccidentCube];
----------------------------------------------------------------------
4. Ảnh hưởng của tầm nhìn (VISIBILITY) đến độ nghiêm trọng.

SELECT
    {[Measures].[Avg Severity], [Measures].[Total Accidents]} ON COLUMNS,
    [Weather].[Visibility].[Visibility].MEMBERS ON ROWS
FROM [AccidentCube];
----------------------------------------------------------------------
5. Phân bố tai nạn theo quý và năm.

SELECT
    {[Measures].[Total Accidents]} ON COLUMNS,
    NON EMPTY CROSSJOIN(
        [Time].[Year].[Year].MEMBERS,
        [Time].[Quarter].[Quarter].MEMBERS
    ) ON ROWS
FROM [AccidentCube];
----------------------------------------------------------------------
6. Phân tích mức độ nghiêm trọng tai nạn theo từng giai đoạn ánh sáng (dựa trên twilight).

SELECT
    {[Measures].[Avg Severity], [Measures].[Total Accidents]} ON COLUMNS,
    NON EMPTY CROSSJOIN(
        [Weather].[Sunrise Sunset].[Sunrise Sunset].MEMBERS,
        [Weather].[Civil Twilight].[Civil Twilight].MEMBERS,
        [Weather].[Nautical Twilight].[Nautical Twilight].MEMBERS,
        [Weather].[Astronomical Twilight].[Astronomical Twilight].MEMBERS
    ) ON ROWS
FROM [AccidentCube];
-----------------------------------------------------------------------
7. Danh sách tai nạn gần đường sắt hoặc trạm xe lửa theo từng năm.

SELECT
    {[Measures].[Total Accidents]} ON COLUMNS,
    NON EMPTY CROSSJOIN(
        [Time].[Year].[Year].MEMBERS,
        [Environment].[Railway].[Railway].MEMBERS,
        [Environment].[Station].[Station].MEMBERS
    ) ON ROWS
FROM [AccidentCube];
-----------------------------------------------------------------------
8. Tần suất và mức độ nghiêm trọng của tai nạn gần các tiện ích.

SELECT
    {[Measures].[Total Accidents], [Measures].[Avg Severity]} ON COLUMNS,
    [Environment].[Amenity].[Amenity].MEMBERS ON ROWS
FROM [AccidentCube];
-----------------------------------------------------------------------
9. Top 10 con đường nguy hiểm nhất và các yếu tố môi trường liên quan.

SELECT
    {[Measures].[Total Accidents], [Measures].[Avg Severity]} ON COLUMNS,
    TOPCOUNT(
        [Location].[Street].[Street].MEMBERS,
        10,
        [Measures].[Total Accidents]
    ) ON ROWS
FROM [AccidentCube];
-----------------------------------------------------------------------
10. Top 5 địa điểm tai nạn theo độ nghiêm trọng trung bình.

SELECT
    {[Measures].[Avg Severity], [Measures].[Total Accidents]} ON COLUMNS,
    TOPCOUNT(
        [Location].[City].[City].MEMBERS,
        5,
        [Measures].[Avg Severity]
    ) ON ROWS
FROM [AccidentCube];
------------------------------------------------------------------------
11. Phân tích mối liên hệ giữa điều kiện thời tiết khắc nghiệt và số lượng/mức độ tai nạn.

SELECT
    {[Measures].[Total Accidents], [Measures].[Avg Severity]} ON COLUMNS,
    FILTER(
        [Weather].[Weather Condition].[Weather Condition].MEMBERS,
        [Weather].[Weather Condition].CURRENTMEMBER.NAME MATCHES ".*Rain.*|.*Snow.*|.*Fog.*|.*Thunder.*"
    ) ON ROWS
FROM [AccidentCube];
-------------------------------------------------------------------------
12. Xếp hạng 5 thành phố có số vụ tai nạn cao nhất trong mỗi tiểu bang.

SELECT
    {[Measures].[Total Accidents]} ON COLUMNS,
    NONEMPTY(
        GENERATE(
            [Location].[State].[State].MEMBERS,
            TOPCOUNT(
                [Location].[City].[City].MEMBERS,
                5,
                ([Location].[State].CURRENTMEMBER, [Measures].[Total Accidents])
            )
        )
    ) ON ROWS
FROM [AccidentCube];
-------------------------------------------------------------------------
13. Phân tích tốc độ tăng trưởng số vụ tai nạn qua từng năm theo tiểu bang.

WITH MEMBER [Measures].[YoY Growth %] AS
    ([Time].[Year].CURRENTMEMBER, [Measures].[Total Accidents]) /
    ([Time].[Year].CURRENTMEMBER.PREVMEMBER, [Measures].[Total Accidents]) - 1,
    FORMAT_STRING = "Percent"

SELECT
    {[Measures].[Total Accidents], [Measures].[YoY Growth %]} ON COLUMNS,
    [Location].[State].[State].MEMBERS ON ROWS
FROM [AccidentCube];
-------------------------------------------------------------------------
14. Top 5 thành phố có tốc độ tăng trưởng tai nạn trung bình cao nhất giai đoạn 2019–2022

WITH MEMBER [Measures].[YoY Growth %] AS
    ([Time].[Year].CURRENTMEMBER, [Measures].[Total Accidents]) /
    ([Time].[Year].CURRENTMEMBER.PREVMEMBER, [Measures].[Total Accidents]) - 1,
    FORMAT_STRING = "Percent"

SELECT
    {[Measures].[YoY Growth %]} ON COLUMNS,
    TOPCOUNT(
        [Location].[City].[City].MEMBERS,
        5,
        AVG(
            { [Time].[Year].[2019] : [Time].[Year].[2022] },
            [Measures].[YoY Growth %]
        )
    ) ON ROWS
FROM [AccidentCube];
------------------------------------------------------------------------------
15. So sánh mức độ nghiêm trọng trung bình của tai nạn giữa cuối tuần và ngày thường theo từng giờ trong ngày.

SELECT
    {[Measures].[Avg Severity], [Measures].[Total Accidents]} ON COLUMNS,
    NON EMPTY CROSSJOIN(
        [Time].[Hour].[Hour].MEMBERS,
        [Time].[Is Weekend].[Is Weekend].MEMBERS
    ) ON ROWS
FROM [AccidentCube];
---------------------------------------------------------------------------------